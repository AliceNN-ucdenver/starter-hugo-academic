<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: February 11, 2024 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.042e26407c9e383d96a1f26d6787c686.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Shawn McCarthy"><meta name=description content="Purpose Using the information already entered to MongoDB for the previous assignment, you will add another collection of reviews that are tied to the movies. This way users can query the database and get the previous information (title, year released and actors) as well as the reviews."><link rel=alternate hreflang=en-us href=https://mccarthy.phd/course/web-api/assignment4/><link rel=canonical href=https://mccarthy.phd/course/web-api/assignment4/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@wowchemy"><meta property="twitter:creator" content="@wowchemy"><meta property="twitter:image" content="https://mccarthy.phd/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="Shawn McCarthy"><meta property="og:url" content="https://mccarthy.phd/course/web-api/assignment4/"><meta property="og:title" content="Assignment Four | Shawn McCarthy"><meta property="og:description" content="Purpose Using the information already entered to MongoDB for the previous assignment, you will add another collection of reviews that are tied to the movies. This way users can query the database and get the previous information (title, year released and actors) as well as the reviews."><meta property="og:image" content="https://mccarthy.phd/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-05-01T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-01T00:00:00+00:00"><title>Assignment Four | Shawn McCarthy</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=43e843e4bf5c54ed38337579a04f346a><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Shawn McCarthy</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Shawn McCarthy</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#talks><span>Talks</span></a></li><li class=nav-item><a class=nav-link href=/#featured><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Courses</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/course/web-api/><span>Web APIs</span></a>
<a class=dropdown-item href=/course/gen-ai/><span>Generative Deep Learning</span></a></div></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class="nav-item d-none d-lg-inline-flex"><a class=nav-link href=https://twitter.com/shawnemccarthy data-toggle=tooltip data-placement=bottom title="Follow me on Twitter" target=_blank rel=noopener aria-label="Follow me on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span>
</a><a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span>
</a><a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Web APIs
</span><span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>Search...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li><a href=/course/><i class="fas fa-arrow-left pr-1"></i>ðŸ“š Courses</a></li></ul><div class=docs-toc-item><a class=docs-toc-link href=/course/web-api/>Web APIs</a><ul class="nav docs-sidenav"><li><a href=/course/web-api/assignment0/>Assignment Zero</a></li><li><a href=/course/web-api/assignment1/>Assignment One</a></li><li><a href=/course/web-api/assignment2/>Assignment Two</a></li><li><a href=/course/web-api/assignment3/>Assignment Three</a></li><li class=active><a href=/course/web-api/assignment4/>Assignment Four</a></li><li><a href=/course/web-api/assignment5/>Assignment Five</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#purpose>Purpose</a></li><li><a href=#pre-requisites>Pre-requisites</a></li><li><a href=#step-1-create-a-new-collection-for-reviews>Step 1: Create a new Collection for Reviews</a></li><li><a href=#step-2-update-api-to-include-reviews>Step 2: Update API to Include Reviews</a></li><li><a href=#step-3-implement-aggregation-of-reviews-and-movies>Step 3: Implement Aggregation of Reviews and Movies</a></li><li><a href=#step-4-add-custom-analytics-extra-credit>Step 4: Add Custom Analytics (Extra Credit)</a></li><li><a href=#step-5-create-a-postman-test-collection-continued>Step 5: Create a Postman Test Collection (continued)</a></li><li><a href=#step-6-write-the-code>Step 6: Write the Code</a></li><li><a href=#step-7-deployment>Step 7: Deployment</a></li><li><a href=#step-8-create-a-readme-file>Step 8: Create a README file</a></li><li><a href=#step-9-submit-your-work>Step 9: Submit your Work</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><div class=docs-article-container></div><div class=docs-article-container><h1>Assignment Four</h1><article class=article-style><h2 id=purpose>Purpose</h2><p>Using the information already entered to MongoDB for the previous assignment, you will add another collection of reviews that are tied to the movies. This way users can query the database and get the previous information (title, year released and actors) as well as the reviews.</p><p>The purpose of this assignment is to leverage Googleâ€™s analytics policies to gather information about the requests being sent in by users.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>Basic knowledge of JavaScript and Node.js</li><li>MongoDB account and basic understanding of MongoDB and Mongoose</li><li>Google Analytics account</li><li>Postman for testing APIs</li><li>Git and GitHub for version control</li><li>Basic knowledge of deployment to Heroku or Render</li><li>Source code from Assignment3</li><li>Access to <a href=https://classroom.github.com/a/lL__a5zB target=_blank rel=noopener>Classroom</a></li><li>GitHub Classroom will clone the repository <a href=https://github.com/AliceNN-ucdenver/CSC3916_Assignment4 target=_blank rel=noopener>CSC3916_Assignment4</a> for you into your GitHub Classroom repository.</li></ul><h2 id=step-1-create-a-new-collection-for-reviews>Step 1: Create a new Collection for Reviews</h2><p>In your MongoDB database, create a new collection named <code>Reviews</code> to hold reviews about movies. Each review should contain the following fields:</p><ul><li><code>movieId</code>: from the <code>Movies</code> collection</li><li><code>username</code>: name of the reviewer</li><li><code>review</code>: the actual review text</li><li><code>rating</code>: rating out of five stars given by the reviewer</li></ul><div class=mermaid>classDiagram
class Review {
+ObjectId _id
+String movieId
+String username
+String review
+Number rating
}</div><p>Here&rsquo;s an example of a Mongoose schema for the <code>Review</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>reviewSchema</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>mongoose</span><span class=p>.</span><span class=nx>Schema</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>movieId</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=nx>mongoose</span><span class=p>.</span><span class=nx>Schema</span><span class=p>.</span><span class=nx>Types</span><span class=p>.</span><span class=nx>ObjectId</span><span class=p>,</span> <span class=nx>ref</span><span class=o>:</span> <span class=s1>&#39;Movie&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>username</span><span class=o>:</span> <span class=nb>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>review</span><span class=o>:</span> <span class=nb>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>rating</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=nb>Number</span><span class=p>,</span> <span class=nx>min</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>max</span><span class=o>:</span> <span class=mi>5</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><h2 id=step-2-update-api-to-include-reviews>Step 2: Update API to Include Reviews</h2><p>Your API from assignment 3 should be updated to interact with the <code>Reviews</code> collection. It should support <code>GET</code> and <code>POST</code> operations for reviews, with <code>DELETE</code> being optional. The <code>POST</code> operation should be secured with a JWT authorization token.</p><ul><li>If review created send back JSON message <code>{ message: 'Review created!' }</code></li></ul><h2 id=step-3-implement-aggregation-of-reviews-and-movies>Step 3: Implement Aggregation of Reviews and Movies</h2><p>If the user sends a request with the query parameter <code>reviews=true</code>, the response should include the movie information as well as all the reviews for the movie. This aggregation can be done using MongoDB&rsquo;s <code>$lookup</code> operator or Async.js library.</p><p>Here&rsquo;s a quick example of how you could use <code>$lookup</code> in Mongoose to aggregate data from <code>Items</code> and <code>Orders</code> collections:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Order</span><span class=p>.</span><span class=nx>aggregate</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>$match</span><span class=o>:</span> <span class=p>{</span> <span class=nx>_id</span><span class=o>:</span> <span class=nx>orderId</span> <span class=p>}</span> <span class=c1>// replace orderId with the actual order id
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>$lookup</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>from</span><span class=o>:</span> <span class=s2>&#34;items&#34;</span><span class=p>,</span> <span class=c1>// name of the foreign collection
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>localField</span><span class=o>:</span> <span class=s2>&#34;items&#34;</span><span class=p>,</span> <span class=c1>// field in the orders collection
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>foreignField</span><span class=o>:</span> <span class=s2>&#34;_id&#34;</span><span class=p>,</span> <span class=c1>// field in the items collection
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>as</span><span class=o>:</span> <span class=s2>&#34;itemDetails&#34;</span> <span class=c1>// output array where the joined items will be placed
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]).</span><span class=nx>exec</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>result</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// handle error
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><h2 id=step-4-add-custom-analytics-extra-credit>Step 4: Add Custom Analytics (Extra Credit)</h2><p>Create a custom analytics policy that describes the number of times each movie has been reviewed.</p><ul><li>Create a custom analytics policy that describes the number of times each movie has been reviewed. To do this, you will have to send a number of requests for each movie.<ul><li>Custom Dimension: Movie Name</li><li>Custom Metric: Requested: Value 1 (it will aggregate)</li></ul></li><li>Custom Dimension and Metric should be sent with an Event type<ul><li>Event Category: Genre of Movie (e.g. Western)</li><li>Event Action: Url Path (e.g. post /reviews)</li><li>Event Label: API Request for Movie Review</li><li>Event Value: 1</li></ul></li></ul><p>To open up the screens on Google Analytics you need to implement the first property: <a href=https://support.google.com/analytics/answer/10269537Links target=_blank rel=noopener>https://support.google.com/analytics/answer/10269537Links</a> to an external site.</p><p>Also it takes awhile for events to show up (for it to index) so don&rsquo;t worry if you don&rsquo;t see your events immediately.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>bodyParser</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;body-parser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>crypto</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;crypto&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>rp</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;request-promise&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>bodyParser</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>bodyParser</span><span class=p>.</span><span class=nx>urlencoded</span><span class=p>({</span> <span class=nx>extended</span><span class=o>:</span> <span class=kc>false</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>express</span><span class=p>.</span><span class=nx>Router</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>GA_TRACKING_ID</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>GA_KEY</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>trackDimension</span><span class=p>(</span><span class=nx>category</span><span class=p>,</span> <span class=nx>action</span><span class=p>,</span> <span class=nx>label</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>dimension</span><span class=p>,</span> <span class=nx>metric</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;GET&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>url</span><span class=o>:</span> <span class=s1>&#39;https://www.google-analytics.com/collect&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>qs</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>   <span class=c1>// API Version.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>v</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Tracking ID / Property ID.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>tid</span><span class=o>:</span> <span class=nx>GA_TRACKING_ID</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Random Client Identifier. Ideally, this should be a UUID that
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=c1>// is associated with particular user, device, or browser instance.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>cid</span><span class=o>:</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>randomBytes</span><span class=p>(</span><span class=mi>16</span><span class=p>).</span><span class=nx>toString</span><span class=p>(</span><span class=s2>&#34;hex&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Event hit type.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>t</span><span class=o>:</span> <span class=s1>&#39;event&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Event category.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>ec</span><span class=o>:</span> <span class=nx>category</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Event action.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>ea</span><span class=o>:</span> <span class=nx>action</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Event label.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>el</span><span class=o>:</span> <span class=nx>label</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Event value.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>ev</span><span class=o>:</span> <span class=nx>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Custom Dimension
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>cd1</span><span class=o>:</span> <span class=nx>dimension</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=c1>// Custom Metric
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>cm1</span><span class=o>:</span> <span class=nx>metric</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>headers</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>  <span class=s1>&#39;Cache-Control&#39;</span><span class=o>:</span> <span class=s1>&#39;no-cache&#39;</span> <span class=p>}</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>rp</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>route</span><span class=p>(</span><span class=s1>&#39;/test&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Event value must be numeric.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>trackDimension</span><span class=p>(</span><span class=s1>&#39;Feedback&#39;</span><span class=p>,</span> <span class=s1>&#39;Rating&#39;</span><span class=p>,</span> <span class=s1>&#39;Feedback for Movie&#39;</span><span class=p>,</span> <span class=s1>&#39;3&#39;</span><span class=p>,</span> <span class=s1>&#39;Guardian\&#39;s of the Galaxy 2&#39;</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>200</span><span class=p>).</span><span class=nx>send</span><span class=p>(</span><span class=s1>&#39;Event tracked.&#39;</span><span class=p>).</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=nx>router</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;http://localhost:8080/test&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>8080</span><span class=p>);</span>
</span></span></code></pre></div><h2 id=step-5-create-a-postman-test-collection-continued>Step 5: Create a Postman Test Collection (continued)</h2><ul><li>Invalid request (for a movie not in the database) without the review query parameter</li><li>Valid request with the review query parameter (e.g <code>reviews=true</code> on the <code>/movies/:id</code> route)</li><li>Valid save review method that associates a review with a movie (save a review for a movie in your DB)</li><li>Invalid save review (movie missing from DB)</li></ul><h2 id=step-6-write-the-code>Step 6: Write the Code</h2><p>Write the code that fulfills all the requirements mentioned in this assignment.</p><h2 id=step-7-deployment>Step 7: Deployment</h2><p>Deploy your API on Heroku or Render. Make sure your MongoDB database is also accessible from your deployed API.</p><h2 id=step-8-create-a-readme-file>Step 8: Create a README file</h2><p>Create a README.md file at the root of your GitHub repository that includes the following:</p><ul><li>Explanation of your project</li><li>Installation and usage instructions</li><li>Link to your Postman test collection</li><li>The environment settings</li></ul><h2 id=step-9-submit-your-work>Step 9: Submit your Work</h2><p>Submit the URL of your GitHub repository and the deployed API on the designated platform.</p><h1 id=rubric>Rubric</h1><ul><li>This assignment has an extra credit â€“ code the custom analytics that correctly sends the movie name and attach a PDF or Excel report from Google Analytics you receive (+4)</li><li>-2 if missing reviews collection</li><li>-2 if missing query parameters <code>?reviews=true</code> that returns reviews (should include both movie and reviews)</li><li>-1 for each test that is missing (valid request for movie with query parameter, valid save review, invalid movie request, invalid save review) â€“ for max of (-4 for missing all tests)</li><li>-2 if you have to manually copy the JWT token to get their tests to run (versus saving it from the sign-in call)</li><li>Try changing the review data to enter a different review before submitting to validate new review are returned â€“ if not (-1)</li></ul><h1 id=resources>Resources</h1><ul><li><a href=https://github.com/daxko/universal-ga target=_blank rel=noopener>Google Universal Analytics</a></li><li><a href=https://developers.google.com/analytics/devguides/collection/analyticsjs/custom-dims-mets target=_blank rel=noopener>Google Analytics Custom Dimensions and Metrics</a></li><li><a href=https://cloud.google.com/appengine/docs/flexible/nodejs/integrating-with-analytics target=_blank rel=noopener>Google Cloud Integration with Analytics</a></li><li><a href=https://caolan.github.io/async/index.html target=_blank rel=noopener>Async.js</a></li><li><a href=https://support.google.com/analytics/answer/2709829 target=_blank rel=noopener>Google Analytics Support</a></li></ul></article><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/course/web-api/assignment3/ rel=next>Assignment Three</a></div><div class=post-nav-item><div class=meta-nav>Next</div><a href=/course/web-api/assignment5/ rel=prev>Assignment Five</a></div></div></div></div><div class=body-footer><p>Last updated on May 1, 2023</p></div><footer class=site-footer><p class="powered-by copyright-license-text">Â© 2024 Me. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> â€” the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></main></div></div></div><div class=page-footer></div><script src=/js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js></script><script src=https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js integrity="sha256-TIYL00Rhw/8WaoUhYTLX9SKIEFdXxg+yMWSLVUbhiLg=" crossorigin=anonymous title=mermaid></script><script src=https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":false}</script><script src=/en/js/wowchemy.min.2945731fa88332cb0ec33cf47d29879f.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy
</a><a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.af9327db0521d4a01354bfc8b77a4324.js type=module></script></body></html>